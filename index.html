<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ì˜†ì—ì„œ ì½” ê³¨ì•„ë„ ì  ì˜ ì˜¤ëŠ” ì†Œë¦¬</title>

    <!-- SEO -->
    <meta
      name="description"
      content="ì½”ê³¨ì´Â·ì£¼ë³€ ì†ŒìŒì´ ìˆì–´ë„ ì ë“¤ê¸° í™˜ê²½ì„ ë•ëŠ” ì†Œë¦¬. ë¹„ ì†Œë¦¬, íŒŒë„ ì†Œë¦¬, ë¶€ë“œëŸ¬ìš´ ì €ìŒ ì œê³µ. ì ë“¤ê¸° ì¢‹ì€ ì£¼íŒŒìˆ˜ì™€ ìˆ˜ë©´ ê°€ì´ë“œ í¬í•¨."
    />
    <meta
      name="keywords"
      content="ì ë“¤ê¸° ì†Œë¦¬, ìˆ˜ë©´ ë„ìš°ë¯¸, í™”ì´íŠ¸ ë…¸ì´ì¦ˆ, í•‘í¬ ë…¸ì´ì¦ˆ, ë¹„ ì†Œë¦¬, íŒŒë„ ì†Œë¦¬, ì½”ê³¨ì´ ì°¨ë‹¨, ìˆ˜ë©´ ì£¼íŒŒìˆ˜, ìì—° ì†Œë¦¬, ìˆ˜ë©´ ê°€ì´ë“œ"
    />
    <meta name="robots" content="index,follow" />
    <link rel="canonical" href="https://funnyfunny.cloud/sleep-sound/" />

    <!-- OG (English image text only) -->
    <meta property="og:title" content="Sleep Sound Helper" />
    <meta
      property="og:description"
      content="Sounds that help you fall asleep even with noise or snoring."
    />
    <meta
      property="og:image"
      content="https://dummyimage.com/1200x630/0b1220/ffffff&text=Sleep+Sound+Helper"
    />
    <meta property="og:type" content="website" />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='14' fill='%230b1220'/%3E%3Ctext x='32' y='42' text-anchor='middle' font-size='26' fill='white'%3EZz%3C/text%3E%3C/svg%3E"
    />

    <script src="https://cdn.tailwindcss.com"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1204894220949193"
     crossorigin="anonymous"></script>
    <!-- responsive-base -->
    <style>
      /* responsive-base */
      *, *::before, *::after {
        box-sizing: border-box;
      }
      html {
        -webkit-text-size-adjust: 100%;
      }
      img,
      video,
      canvas,
      svg {
        max-width: 100%;
        height: auto;
      }
      table {
        width: 100%;
      }
      pre,
      code {
        white-space: pre-wrap;
        word-break: break-word;
      }
    </style>
  <style>
    .adsense-block {
      margin: 16px 0;
      display: flex;
      justify-content: center;
    }
    .adsbygoogle {
      display: block;
      margin: 16px auto;
        text-align: center;
}
    .lang-switch {
      position: fixed;
      top: 16px;
      right: 16px;
      display: inline-flex;
      gap: 0;
      padding: 3px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      z-index: 100;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .lang-switch button {
      border: none;
      background: transparent;
      color: rgba(226, 232, 240, 0.6);
      font-size: 12px;
      font-weight: 700;
      padding: 7px 14px;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 44px;
      text-align: center;
      letter-spacing: 0.02em;
    }
    .lang-switch button.active {
      background: rgba(255, 255, 255, 0.3);
      color: #e2e8f0;
      box-shadow: 0 2px 8px rgba(255, 255, 255, 0.4);
    }
    .lang-switch button:not(.active):hover {
      background: rgba(255, 255, 255, 0.1);
      color: rgba(226, 232, 240, 0.9);
    }
  </style>
</head>

  <body
    class="min-h-screen bg-gradient-to-b from-slate-950 to-slate-900 text-white"
  >
    <div class="lang-switch" role="tablist" aria-label="Language switcher">
      <button type="button" data-lang="ko" class="active">KR</button>
      <button type="button" data-lang="en">EN</button>
    </div>
    <main class="max-w-md md:max-w-4xl mx-auto px-4 py-6 md:py-10">
      <!-- Header -->
      <header class="text-center mb-6 md:mb-8">
        <h1 class="text-2xl md:text-3xl font-extrabold" data-i18n="title">ì ë“¤ê¸° ë„ìš°ë¯¸</h1>
        <p class="mt-2 text-sm md:text-base text-white/70" data-i18n="subtitle">
          ì½”ê³¨ì´Â·ì£¼ë³€ ì†ŒìŒì´ ìˆì–´ë„ ì ë“¤ê¸° í™˜ê²½ì„ ë•ëŠ” ì†Œë¦¬
        </p>
      </header>

      <!-- Guide Section (PC only) -->
      <section
        class="hidden md:block rounded-2xl bg-blue-500/10 border border-blue-400/30 p-6 mb-6"
      >
        <h2 class="text-lg font-semibold mb-3" data-i18n="guideTitle">ğŸ’¤ ì ë“¤ê¸° ê°€ì´ë“œ</h2>
        <div class="grid grid-cols-2 gap-4 text-sm">
          <div>
            <h3 class="font-semibold mb-2" data-i18n="guideNoisyTitle">ì‹œë„ëŸ¬ìš´ í™˜ê²½</h3>
            <p class="text-white/70" data-i18n="guideNoisyDesc">
              í•‘í¬ ë…¸ì´ì¦ˆë‚˜ í™”ì´íŠ¸ ë…¸ì´ì¦ˆë¥¼ ì‚¬ìš©í•˜ì—¬ ì£¼ë³€ ì†ŒìŒì„ ê°€ë ¤ì£¼ì„¸ìš”.
              íŠ¹íˆ ì½”ê³¨ì´ë‚˜ ë„ë¡œ ì†ŒìŒì— íš¨ê³¼ì ì…ë‹ˆë‹¤.
            </p>
          </div>
          <div>
            <h3 class="font-semibold mb-2" data-i18n="guideQuietTitle">ì¡°ìš©í•œ í™˜ê²½</h3>
            <p class="text-white/70" data-i18n="guideQuietDesc">
              ë¶€ë“œëŸ¬ìš´ ì €ìŒì´ë‚˜ ìì—° ì†Œë¦¬(ë¹„, íŒŒë„)ë¥¼ ì‚¬ìš©í•˜ë©´ ë” ê¹Šì€ ì ì— ë¹ ì§ˆ
              ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
          </div>
          <div>
            <h3 class="font-semibold mb-2" data-i18n="guideVolumeTitle">ë³¼ë¥¨ ì¡°ì ˆ</h3>
            <p class="text-white/70" data-i18n="guideVolumeDesc">
              ë„ˆë¬´ í¬ì§€ ì•Šê²Œ ì¡°ì ˆí•˜ì„¸ìš”. ë³´í†µ 40-60% ì •ë„ê°€ ì ë‹¹í•˜ë©°, ì£¼ë³€
              ì†ŒìŒë³´ë‹¤ ì•½ê°„ í¬ê²Œë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.
            </p>
          </div>
          <div>
            <h3 class="font-semibold mb-2" data-i18n="guideTimerTitle">íƒ€ì´ë¨¸ í™œìš©</h3>
            <p class="text-white/70" data-i18n="guideTimerDesc">
              ìˆ˜ë©´ ì‹œê°„ì— ë§ì¶° íƒ€ì´ë¨¸ë¥¼ ì„¤ì •í•˜ë©´ ìë™ìœ¼ë¡œ êº¼ì ¸ì„œ ê¹Šì€ ì ì„
              ë°©í•´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            </p>
          </div>
        </div>
      </section>

      <!-- Frequency Info Section -->
      <section
        class="rounded-2xl bg-purple-500/10 border border-purple-400/30 p-4 md:p-6 mb-4"
      >
        <button
          onclick="toggleFrequencyInfo()"
          class="w-full flex items-center justify-between text-left"
        >
          <h2 class="text-sm md:text-base font-semibold" data-i18n="frequencyTitle">
            ğŸµ ì ë“¤ê¸° ì¢‹ì€ ì£¼íŒŒìˆ˜ ì•Œì•„ë³´ê¸°
          </h2>
          <span id="frequencyToggle" class="text-xl">â–¼</span>
        </button>
        <div
          id="frequencyInfo"
          class="hidden mt-4 space-y-3 text-xs md:text-sm"
        >
          <div class="bg-white/5 rounded-lg p-3">
            <h3 class="font-semibold mb-1" data-i18n="deltaTitle">ë¸íƒ€íŒŒ (0.5-4Hz)</h3>
            <p class="text-white/70" data-i18n="deltaDesc">
              ê°€ì¥ ê¹Šì€ ìˆ˜ë©´ ë‹¨ê³„ì—ì„œ ë‚˜íƒ€ë‚˜ëŠ” ì£¼íŒŒìˆ˜ì…ë‹ˆë‹¤. ê·€ë¡œ ë“¤ì„ ìˆ˜ ì—†ì–´
              60Hz ì •ë„ì˜ ë¶€ë“œëŸ¬ìš´ ì €ìŒê³¼ íŒŒë„ ë¦¬ë“¬ìœ¼ë¡œ ë¸íƒ€ ëŠë‚Œì„ ë§Œë“­ë‹ˆë‹¤
              (ë¶€ë“œëŸ¬ìš´ ì €ìŒ, íŒŒë„ ì†Œë¦¬ì™€ ì˜ ì–´ìš¸ë¦¼).
            </p>
          </div>
          <div class="bg-white/5 rounded-lg p-3">
            <h3 class="font-semibold mb-1" data-i18n="thetaTitle">ì„¸íƒ€íŒŒ (4-8Hz)</h3>
            <p class="text-white/70" data-i18n="thetaDesc">
              ê¹Šì€ íœ´ì‹ê³¼ ëª…ìƒ ìƒíƒœì—ì„œ ë‚˜íƒ€ë‚˜ë©°, ì ë“¤ê¸° ì§ì „ ë‹¨ê³„ì—ì„œ ë„ì›€ì´
              ë©ë‹ˆë‹¤. í•‘í¬ ë…¸ì´ì¦ˆë‚˜ ë¹„/íŒŒë„ ê°™ì€ ëŠë¦° íŒŒë™ ì†Œë¦¬ê°€ ì„¸íƒ€ ì˜ì—­
              ê°ê°ì„ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.
            </p>
          </div>
          <div class="bg-white/5 rounded-lg p-3">
            <h3 class="font-semibold mb-1" data-i18n="alphaTitle">ì•ŒíŒŒíŒŒ (8-13Hz)</h3>
            <p class="text-white/70" data-i18n="alphaDesc">
              í¸ì•ˆí•œ ê°ì„± ìƒíƒœë¡œ, ê¸´ì¥ì„ í’€ê³  ì ë“¤ ì¤€ë¹„ë¥¼ í•  ë•Œ ë„ì›€ì´ ë©ë‹ˆë‹¤.
            </p>
          </div>
          <div class="bg-white/5 rounded-lg p-3">
            <h3 class="font-semibold mb-1" data-i18n="whiteNoiseTitle">í™”ì´íŠ¸ ë…¸ì´ì¦ˆ</h3>
            <p class="text-white/70" data-i18n="whiteNoiseDesc">
              ëª¨ë“  ì£¼íŒŒìˆ˜ë¥¼ ê· ë“±í•˜ê²Œ í¬í•¨í•˜ì—¬ ì£¼ë³€ ì†ŒìŒì„ íš¨ê³¼ì ìœ¼ë¡œ ê°€ë¦½ë‹ˆë‹¤.
              ì½”ê³¨ì´ë‚˜ ë„ë¡œ ì†ŒìŒ ì°¨ë‹¨ì— ì¢‹ìŠµë‹ˆë‹¤.
            </p>
          </div>
          <div class="bg-white/5 rounded-lg p-3">
            <h3 class="font-semibold mb-1" data-i18n="pinkNoiseTitle">í•‘í¬ ë…¸ì´ì¦ˆ</h3>
            <p class="text-white/70" data-i18n="pinkNoiseDesc">
              ê³ ì£¼íŒŒë³´ë‹¤ ì €ì£¼íŒŒì— ë” ë§ì€ ì—ë„ˆì§€ë¥¼ ê°€ì§„ ë…¸ì´ì¦ˆë¡œ, í™”ì´íŠ¸
              ë…¸ì´ì¦ˆë³´ë‹¤ ë” ìì—°ìŠ¤ëŸ½ê³  í¸ì•ˆí•©ë‹ˆë‹¤.
            </p>
          </div>
        </div>
      </section>

      <!-- Situation -->
      <section
        class="rounded-2xl bg-white/5 border border-white/10 p-4 md:p-6 mb-4"
      >
        <p class="text-sm text-white/70 mb-2" data-i18n="situationLabel">ì§€ê¸ˆ ì£¼ë³€ì€ ì–´ë–¤ê°€ìš”?</p>
        <div class="grid grid-cols-2 gap-3">
          <button
            onclick="recommend('quiet')"
            class="py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all active:scale-95"
            data-i18n="situationQuiet"
          >
            ì§€ê¸ˆ ì¡°ìš©í•¨
          </button>
          <button
            onclick="recommend('noisy')"
            class="py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all active:scale-95"
            data-i18n="situationNoisy"
          >
            ì§€ê¸ˆ ì‹œë„ëŸ¬ì›€
          </button>
        </div>
      </section>

      <!-- Current Status -->
      <section
        id="statusSection"
        class="rounded-2xl bg-emerald-500/20 border border-emerald-400/40 p-4 mb-4 hidden"
      >
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <span class="text-lg">ğŸ”Š</span>
            <div>
              <p class="text-sm font-semibold" id="currentSound" data-i18n="statusPlaying">ì¬ìƒ ì¤‘</p>
              <p class="text-xs text-white/70" id="timerStatus"></p>
            </div>
          </div>
          <button
            onclick="stopAll()"
            class="px-3 py-1 rounded-lg bg-white/20 hover:bg-white/30 text-sm"
            data-i18n="statusStop"
          >
            ì •ì§€
          </button>
        </div>
      </section>

      <!-- Custom Audio -->
      <section
        class="rounded-2xl bg-white/5 border border-white/10 p-4 md:p-6 mb-4"
      >
        <p class="text-sm text-white/70 mb-3" data-i18n="customAudioLabel">ë‚´ ì†Œë¦¬ ì¶”ê°€</p>
        <div class="space-y-3">
          <div>
            <label class="block text-xs text-white/60 mb-2" data-i18n="fileUploadLabel">íŒŒì¼ ì—…ë¡œë“œ</label>
            <input
              type="file"
              id="audioFileInput"
              accept="audio/*"
              onchange="handleFileUpload(event)"
              class="hidden"
            />
            <button
              onclick="document.getElementById('audioFileInput').click()"
              class="w-full py-2 px-4 rounded-lg bg-white/10 hover:bg-white/15 transition-all text-sm flex items-center justify-center gap-2"
              data-i18n="fileSelect"
            >
              <span>ğŸ“</span>
              <span>íŒŒì¼ ì„ íƒ</span>
            </button>
            <p id="fileName" class="text-xs text-white/50 mt-2 text-center"></p>
          </div>
          <div id="overlaySection" class="hidden">
            <label class="block text-xs text-white/60 mb-2" data-i18n="overlayLabel"
              >ë§ì”Œìš°ê¸° (ì„ íƒ)</label
            >
            <div class="grid grid-cols-2 gap-2 text-sm">
              <button
                onclick="addNoiseOverlay('white')"
                class="py-2 rounded-lg bg-white/10 hover:bg-white/15 transition-all"
                data-i18n="overlayWhite"
              >
                í™”ì´íŠ¸ ë…¸ì´ì¦ˆ
              </button>
              <button
                onclick="addNoiseOverlay('pink')"
                class="py-2 rounded-lg bg-white/10 hover:bg-white/15 transition-all"
                data-i18n="overlayPink"
              >
                í•‘í¬ ë…¸ì´ì¦ˆ
              </button>
              <button
                onclick="removeNoiseOverlay()"
                class="py-2 rounded-lg bg-gray-700/50 hover:bg-gray-700/70 transition-all col-span-2"
                data-i18n="overlayRemove"
              >
                ë§ì”Œìš°ê¸° ì œê±°
              </button>
            </div>
            <p
              id="overlayStatus"
              class="text-xs text-white/50 mt-2 text-center"
            ></p>
            <p class="text-[11px] text-white/40 mt-1 text-center" data-i18n="overlayHint">
              ìœ„ì˜ ì†Œë¦¬Â·ìì—° ì†Œë¦¬ ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ ë‚´ íŒŒì¼ ìœ„ì— ë§ì”Œìš¸ ìˆ˜ ìˆì–´ìš”
            </p>
          </div>
        </div>
      </section>

      <!-- Sound Buttons -->
      <section
        class="rounded-2xl bg-white/5 border border-white/10 p-4 md:p-6 mb-4"
      >
        <p class="text-sm text-white/70 mb-3" data-i18n="soundSelectLabel">ì†Œë¦¬ ì„ íƒ</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <button
            onclick="playNoise('white')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="í™”ì´íŠ¸ ë…¸ì´ì¦ˆ"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="whiteNoiseBtn">í™”ì´íŠ¸ ë…¸ì´ì¦ˆ (20Hz~20kHz)</span>
            </span>
          </button>
          <button
            onclick="playNoise('pink')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="í•‘í¬ ë…¸ì´ì¦ˆ"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="pinkNoiseBtn">í•‘í¬ ë…¸ì´ì¦ˆ (ì €ìŒ ê°•í™”)</span>
            </span>
          </button>
          <button
            onclick="playAudio('rain')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="ë¹„ ì˜¤ëŠ” ì†Œë¦¬"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="rainBtn">ë¹„ ì˜¤ëŠ” ì†Œë¦¬ (500~8kHz ëŠë‚Œ)</span>
            </span>
          </button>
          <button
            onclick="playAudio('wave')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="íŒŒë„ ì†Œë¦¬"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="waveBtn">íŒŒë„ ì†Œë¦¬ (1~200Hz ë¦¬ë“¬)</span>
            </span>
          </button>
          <button
            onclick="playLow()"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="ë¶€ë“œëŸ¬ìš´ ì €ìŒ"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="lowBtn">ë¶€ë“œëŸ¬ìš´ ì €ìŒ (60Hz)</span>
            </span>
          </button>
        </div>
      </section>

      <!-- Nature Sounds -->
      <section
        class="rounded-2xl bg-white/5 border border-white/10 p-4 md:p-6 mb-4"
      >
        <p class="text-sm text-white/70 mb-3" data-i18n="natureLabel">ğŸŒ¿ ìì—° ì†Œë¦¬</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <button
            onclick="playNatureSound('wind')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="ë°”ëŒ ì†Œë¦¬"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="windBtn">ë°”ëŒ ì†Œë¦¬ (200~800Hz)</span>
            </span>
          </button>
          <button
            onclick="playNatureSound('fireplace')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="ë²½ë‚œë¡œ ì†Œë¦¬"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="fireplaceBtn">ë²½ë‚œë¡œ ì†Œë¦¬ (60~200Hz)</span>
            </span>
          </button>
          <button
            onclick="playNatureSound('forest')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="ìˆ² ì†Œë¦¬"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="forestBtn">ìˆ² ì†Œë¦¬ (2~4kHz ìƒˆì†Œë¦¬)</span>
            </span>
          </button>
          <button
            onclick="playNatureSound('stream')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="ì‹œëƒ‡ë¬¼ ì†Œë¦¬"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="streamBtn">ì‹œëƒ‡ë¬¼ ì†Œë¦¬ (300~2kHz)</span>
            </span>
          </button>
          <button
            onclick="playNatureSound('thunder')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="ì²œë‘¥ ì†Œë¦¬"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="thunderBtn">ì²œë‘¥ ì†Œë¦¬ (40~120Hz)</span>
            </span>
          </button>
          <button
            onclick="playNatureSound('birds')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="ì•„ì¹¨ ìƒˆì†Œë¦¬"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="birdsBtn">ì•„ì¹¨ ìƒˆì†Œë¦¬ (3~8kHz)</span>
            </span>
          </button>
          <button
            onclick="playNatureSound('night')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="ë°¤ ë²Œë ˆ ì†Œë¦¬"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="nightBtn">ë°¤ ë²Œë ˆ ì†Œë¦¬ (2~6kHz)</span>
            </span>
          </button>
          <button
            onclick="playNatureSound('meadow')"
            class="sound-btn w-full py-3 rounded-xl bg-white/10 hover:bg-white/15 transition-all"
            data-name="ë“¤íŒ ë°”ëŒ ì†Œë¦¬"
          >
            <span class="flex items-center justify-center gap-2">
              <span class="sound-icon">ğŸ”‡</span>
              <span data-i18n="meadowBtn">ë“¤íŒ ë°”ëŒ ì†Œë¦¬ (200~1kHz)</span>
            </span>
          </button>
        </div>
      </section>

      <!-- Volume Control -->
      <section
        class="rounded-2xl bg-white/5 border border-white/10 p-4 md:p-6 mb-4"
      >
        <p class="text-sm text-white/70 mb-3" data-i18n="volumeLabel">ë³¼ë¥¨ ì¡°ì ˆ</p>
        <div class="flex items-center gap-3">
          <span class="text-lg">ğŸ”‰</span>
          <input
            type="range"
            id="volumeSlider"
            min="0"
            max="100"
            value="60"
            oninput="setVolume(this.value)"
            class="flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"
          />
          <span id="volumeValue" class="text-sm w-12 text-right">60%</span>
        </div>
      </section>

      <!-- Timer -->
      <section
        class="rounded-2xl bg-white/5 border border-white/10 p-4 md:p-6 mb-4"
      >
        <p class="text-sm text-white/70 mb-3" data-i18n="timerLabel">íƒ€ì´ë¨¸</p>
        <div class="grid grid-cols-4 gap-2 text-sm">
          <button
            onclick="setTimer(15, this)"
            class="timer-btn py-2 rounded-lg bg-white/10 hover:bg-white/15 transition-all"
            data-i18n="timer15"
          >
            15ë¶„
          </button>
          <button
            onclick="setTimer(30, this)"
            class="timer-btn py-2 rounded-lg bg-white/10 hover:bg-white/15 transition-all"
            data-i18n="timer30"
          >
            30ë¶„
          </button>
          <button
            onclick="setTimer(60, this)"
            class="timer-btn py-2 rounded-lg bg-white/10 hover:bg-white/15 transition-all"
            data-i18n="timer60"
          >
            1ì‹œê°„
          </button>
          <button
            onclick="setTimer(0, this)"
            class="timer-btn py-2 rounded-lg bg-white/10 hover:bg-white/15 transition-all"
            data-i18n="timerContinue"
          >
            ê³„ì†
          </button>
        </div>
      </section>

      <!-- Child Mode -->
      <section
        class="rounded-2xl bg-emerald-500/10 border border-emerald-400/30 p-4 md:p-6 mb-6"
      >
        <p class="font-semibold mb-2" data-i18n="childModeTitle">ğŸ‘¶ ì•„ì´ ì¬ìš°ê¸° ëª¨ë“œ</p>
        <p class="text-sm text-white/70 mb-3" data-i18n="childModeDesc">
          ê°‘ì‘ìŠ¤ëŸ¬ìš´ ì†Œë¦¬ ì—†ëŠ”, ì•„ì£¼ ì¼ì •í•œ ì†Œë¦¬ë§Œ ì œê³µí•©ë‹ˆë‹¤
        </p>
        <button
          onclick="childMode()"
          class="w-full py-3 rounded-xl bg-emerald-500 text-slate-950 font-semibold hover:bg-emerald-600 transition-all active:scale-95"
          data-i18n="childModeStart"
        >
          ì•„ì´ ì¬ìš°ê¸° ì‹œì‘
        </button>
      </section>

      <!-- Stop -->
      <button
        onclick="stopAll()"
        class="w-full py-3 rounded-xl bg-gray-800 hover:bg-gray-700 mb-6 transition-all active:scale-95"
        data-i18n="stopBtn"
      >
        ì •ì§€
      </button>

      <!-- Footer -->
      <div class="space-y-4">
        <div
          class="md:hidden rounded-2xl bg-blue-500/10 border border-blue-400/30 p-4 mb-4"
        >
          <h3 class="text-sm font-semibold mb-2" data-i18n="quickGuideTitle">ğŸ’¡ ë¹ ë¥¸ ê°€ì´ë“œ</h3>
          <ul class="text-xs text-white/70 space-y-1">
            <li data-i18n="quickGuide1">â€¢ ì‹œë„ëŸ¬ìš´ í™˜ê²½: í•‘í¬/í™”ì´íŠ¸ ë…¸ì´ì¦ˆ ì‚¬ìš©</li>
            <li data-i18n="quickGuide2">â€¢ ì¡°ìš©í•œ í™˜ê²½: ìì—° ì†Œë¦¬ë‚˜ ë¶€ë“œëŸ¬ìš´ ì €ìŒ</li>
            <li data-i18n="quickGuide3">â€¢ ë³¼ë¥¨ì€ 40-60% ì •ë„ê°€ ì ë‹¹í•©ë‹ˆë‹¤</li>
            <li data-i18n="quickGuide4">â€¢ íƒ€ì´ë¨¸ë¥¼ ì„¤ì •í•˜ë©´ ìë™ìœ¼ë¡œ êº¼ì§‘ë‹ˆë‹¤</li>
          </ul>
        </div>

        <p class="text-xs text-white/50 text-center leading-relaxed" data-i18n-html="footer">
          ë³¸ ì„œë¹„ìŠ¤ëŠ” ì˜ë£ŒÂ·ìˆ˜ë©´ ì¹˜ë£Œ ëª©ì ì´ ì•„ë‹Œ<br />
          ì ë“¤ê¸° í™˜ê²½ì„ ë•ê¸° ìœ„í•œ ì°¸ê³ ìš© ì†Œë¦¬ ì œê³µ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.
        </p>
      </div>

      <div class="flex justify-center pt-6 mt-8 border-t border-white/10">
        <a
          href="https://funnyfunny.cloud/"
          class="text-sm text-white/60 hover:text-white"
          data-i18n="otherServices"
        >
          ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë³´ê¸°
        </a>
      </div>
    </main>

    <script>
      let ctx,
        source,
        overlaySource,
        timer,
        timerInterval,
        gainNode,
        overlayGainNode,
        currentVolume = 0.6,
        timerMinutes = 0,
        timerEndTime = 0,
        customAudio = null,
        activeBaseName = "",
        overlayName = "";
      let audioUnlocked = false;
      const isIOS = /iP(hone|ad|od)/.test(navigator.userAgent);
      const audioDebug = true;
      const useWavOnIOS = isIOS;

      function logAudio(...args) {
        if (!audioDebug) return;
        console.log("[audio]", ...args);
      }

      function debugBeep() {
        if (!audioDebug || !ctx || ctx.state !== "running") return;
        try {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = "sine";
          osc.frequency.value = 440;
          gain.gain.value = 0.2;
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.start();
          osc.stop(ctx.currentTime + 0.12);
          logAudio("debugBeep: fired");
        } catch (e) {
          logAudio("debugBeep: failed", e);
        }
      }

      const LOOP_SECONDS = 8;
      const LOOP_FADE_SECONDS = 0.05;

      function createLoopBufferSize() {
        return Math.max(1, Math.floor(ctx.sampleRate * LOOP_SECONDS));
      }

      function applyLoopFade(buffer, fadeSeconds = LOOP_FADE_SECONDS) {
        const fadeSamples = Math.min(
          Math.floor(buffer.sampleRate * fadeSeconds),
          Math.floor(buffer.length / 2)
        );
        if (fadeSamples <= 0) return buffer;
        for (let ch = 0; ch < buffer.numberOfChannels; ch++) {
          const data = buffer.getChannelData(ch);
          for (let i = 0; i < fadeSamples; i++) {
            const fadeIn = i / fadeSamples;
            const fadeOut = (fadeSamples - i) / fadeSamples;
            data[i] *= fadeIn;
            data[buffer.length - 1 - i] *= fadeOut;
          }
        }
        return buffer;
      }

      function createSineBuffer(freq) {
        const bufferSize = createLoopBufferSize();
        const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
        const data = buffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) {
          const t = i / ctx.sampleRate;
          const base = Math.sin(2 * Math.PI * freq * t) * 0.32;
          const harmonic = Math.sin(2 * Math.PI * freq * 2 * t) * 0.12;
          const air = (Math.random() * 2 - 1) * 0.01;
          data[i] = base + harmonic + air;
        }
        return applyLoopFade(buffer);
      }

      function createNatureBuffer(type) {
        const bufferSize = createLoopBufferSize();
        const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
        const data = buffer.getChannelData(0);

        for (let i = 0; i < bufferSize; i++) {
          let sample = 0;
          const t = i / ctx.sampleRate;

          switch (type) {
            case "wind":
              sample = (Math.random() * 2 - 1) * 0.25;
              sample *= 0.5 + Math.sin(i * 0.0003) * 0.5;
              break;
            case "fireplace":
              const crackle =
                Math.random() < 0.05 ? (Math.random() * 2 - 1) * 0.4 : 0;
              const base = Math.sin(i * 0.001) * 0.2;
              sample = crackle + base;
              break;
            case "forest":
              const wind = (Math.random() * 2 - 1) * 0.15;
              const bird = Math.random() < 0.003 ? Math.sin(i * 0.01) * 0.2 : 0;
              sample = wind + bird;
              break;
            case "stream":
              const water = (Math.random() * 2 - 1) * 0.3;
              const rhythm = Math.sin(i * 0.002) * 0.1;
              sample = water + rhythm;
              break;
            case "thunder":
              // ì²œë‘¥: ëŠë¦° ì €ì£¼íŒŒ ëŸ¼ë¸” + ê°„í—ì  ê°•í•œ ë²„ìŠ¤íŠ¸
              const rumble = Math.sin(2 * Math.PI * 40 * t) * 0.18;
              const burstGate = Math.max(0, Math.sin(2 * Math.PI * 0.25 * t));
              const burst = burstGate * (Math.random() * 2 - 1) * 0.5;
              sample = rumble + burst;
              break;
            case "birds":
              // ìƒˆì†Œë¦¬: ê·œì¹™ì ì¸ ì§§ì€ ìš¸ìŒ + ë¶€ë“œëŸ¬ìš´ ë°°ê²½
              const chirpGate = Math.max(0, Math.sin(2 * Math.PI * 1.3 * t));
              const chirpFreq = 2800 + 600 * Math.sin(2 * Math.PI * 2.6 * t);
              sample = chirpGate * Math.sin(2 * Math.PI * chirpFreq * t) * 0.35;
              sample += (Math.random() * 2 - 1) * 0.03;
              break;
            case "night":
              // ë°¤ë²Œë ˆ: ë†’ì€ í†¤ì˜ ì¼ì •í•œ ìš¸ìŒ + ì €ì£¼íŒŒ ë°”ë‹¥
              const cricketGate = Math.max(0, Math.sin(2 * Math.PI * 3.2 * t));
              const cricket = Math.sin(2 * Math.PI * 4200 * t) * 0.22;
              const hum = Math.sin(2 * Math.PI * 120 * t) * 0.04;
              sample = cricketGate * cricket + hum;
              sample += (Math.random() * 2 - 1) * 0.02;
              break;
            case "meadow":
              const breeze = (Math.random() * 2 - 1) * 0.18;
              const gust = Math.sin(i * 0.0005) * 0.1;
              const farBird =
                Math.random() < 0.0008 ? Math.sin(i * 0.02) * 0.15 : 0;
              sample = breeze + gust + farBird;
              break;
          }

          data[i] = sample;
        }

        return applyLoopFade(buffer);
      }

      function init() {
        if (!ctx) {
          ctx = new (window.AudioContext || window.webkitAudioContext)({
            latencyHint: "interactive",
          });
          gainNode = ctx.createGain();
          gainNode.connect(ctx.destination);
          gainNode.gain.value = currentVolume;

          overlayGainNode = ctx.createGain();
          overlayGainNode.connect(ctx.destination);
          overlayGainNode.gain.value = 0;
          logAudio("init: created AudioContext", {
            state: ctx.state,
            sampleRate: ctx.sampleRate,
          });
          ctx.onstatechange = () => {
            logAudio("AudioContext statechange", ctx.state);
          };
        }
        resumeContext();
      }

      function resumeContext() {
        if (!ctx) return;
        if (ctx.state === "suspended") {
          logAudio("resumeContext: suspended -> resume()");
          ctx
            .resume()
            .then(() => {
              logAudio("resumeContext: state after resume", ctx.state);
            })
            .catch((e) => {
              console.error("Failed to resume audio context:", e);
            });
        } else {
          logAudio("resumeContext: state", ctx.state);
        }
      }

      function tryUnlockAudio() {
        if (!audioUnlocked && ctx && ctx.state === "running") {
          try {
            const buffer = ctx.createBuffer(1, 1, ctx.sampleRate);
            const sourceNode = ctx.createBufferSource();
            sourceNode.buffer = buffer;
            sourceNode.connect(gainNode);
            sourceNode.start(0);
          } catch {}
          audioUnlocked = true;
          logAudio("tryUnlockAudio: unlocked");
        }
      }

      function withAudioContext(action) {
        init();
        if (ctx && ctx.state !== "running") {
          resumeContext();
          showNotification(t("audioActivating"));
          logAudio("withAudioContext: blocked, waiting for running", {
            state: ctx?.state,
            unlocked: audioUnlocked,
          });
          return;
        }
        tryUnlockAudio();
        logAudio("withAudioContext: before action", {
          state: ctx?.state,
          unlocked: audioUnlocked,
          gain: gainNode?.gain?.value,
        });
        action();
        logAudio("withAudioContext: after action", {
          state: ctx?.state,
          unlocked: audioUnlocked,
          gain: gainNode?.gain?.value,
        });
      }

      function showStatus(soundName) {
        const statusSection = document.getElementById("statusSection");
        activeBaseName = soundName;
        updateStatusLabel();
        statusSection.classList.remove("hidden");
        updateTimerDisplay();
      }

      function hideStatus() {
        const statusSection = document.getElementById("statusSection");
        statusSection.classList.add("hidden");
        timerMinutes = 0;
      }

      function updateStatusLabel() {
        const currentSound = document.getElementById("currentSound");
        if (!currentSound) return;
        const names = [];
        if (activeBaseName) {
          const soundNames = t("soundNames");
          names.push(soundNames[activeBaseName] || activeBaseName);
        }
        if (overlayName) {
          const soundNames = t("soundNames");
          names.push(soundNames[overlayName] || overlayName);
        }
        currentSound.textContent = names.join(" + ") || t("statusPlaying");
      }

      function updateTimerDisplay() {
        const timerStatus = document.getElementById("timerStatus");
        if (timerEndTime > 0) {
          const now = Date.now();
          const remaining = Math.max(0, timerEndTime - now);
          if (remaining > 0) {
            const minutes = Math.floor(remaining / 60000);
            const seconds = Math.floor((remaining % 60000) / 1000);
            timerStatus.textContent = t("timerRemaining", {
              minutes,
              seconds: seconds.toString().padStart(2, "0"),
            });
          } else {
            timerStatus.textContent = t("timerContinue");
          }
        } else {
          timerStatus.textContent = t("timerContinue");
        }
      }

      function stopOverlay() {
        if (overlaySource) {
          try {
            overlaySource.stop();
          } catch {}
          overlaySource = null;
        }
        overlayName = "";
        if (overlayGainNode) {
          overlayGainNode.gain.value = 0;
        }

        updateOverlayStatus("");
        updateStatusLabel();
      }

      function stopAll() {
        if (source) {
          try {
            if (source.stop) source.stop();
            if (source.pause) source.pause();
          } catch {}
          // ì˜¤ë¸Œì íŠ¸ URL ì •ë¦¬
          if (source.src && source.src.startsWith("blob:")) {
            URL.revokeObjectURL(source.src);
          }
          source = null;
        }
        stopOverlay();
        if (customAudio) {
          try {
            customAudio.pause();
            if (customAudio.src && customAudio.src.startsWith("blob:")) {
              URL.revokeObjectURL(customAudio.src);
            }
          } catch {}
          customAudio = null;
        }
        if (timer) {
          clearTimeout(timer);
          timer = null;
        }
        if (timerInterval) {
          clearInterval(timerInterval);
          timerInterval = null;
        }
        timerEndTime = 0;
        overlayName = "";
        activeBaseName = "";
        hideStatus();
        resetButtonStates();

        // íŒŒì¼ëª… ì´ˆê¸°í™”
        const fileName = document.getElementById("fileName");
        if (fileName) fileName.textContent = "";

        // ì˜¤ë²„ë ˆì´ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
        const overlaySection = document.getElementById("overlaySection");
        if (overlaySection) overlaySection.classList.add("hidden");
      }

      function resetButtonStates() {
        document.querySelectorAll(".sound-btn").forEach((btn) => {
          btn.classList.remove("bg-emerald-500/30", "hover:bg-emerald-500/30");
          btn.classList.add("bg-white/10");
          const icon = btn.querySelector(".sound-icon");
          if (icon) icon.textContent = "ğŸ”‡";
        });
        document.querySelectorAll(".timer-btn").forEach((btn) => {
          btn.classList.remove("bg-blue-500/30", "hover:bg-blue-500/30");
          btn.classList.add("bg-white/10");
        });
      }

      function highlightButton(button, name) {
        resetButtonStates();
        if (button) {
          button.classList.remove("bg-white/10", "hover:bg-white/15");
          button.classList.add("bg-emerald-500/30", "hover:bg-emerald-500/30");
          const icon = button.querySelector(".sound-icon");
          if (icon) icon.textContent = "ğŸ”Š";
        }
        showStatus(name);
      }

      function setVolume(value) {
        currentVolume = value / 100;
        const volumeValue = document.getElementById("volumeValue");
        volumeValue.textContent = value + "%";

        if (gainNode) {
          gainNode.gain.value = currentVolume;
        }
        if (overlayGainNode && overlaySource) {
          // ë§ì”Œìš´ ì†Œë¦¬ ë³¼ë¥¨ë„ í•¨ê»˜ ì¡°ì ˆ (ê¸°ë³¸ ì˜¤ë””ì˜¤ì˜ 35%)
          overlayGainNode.gain.value = currentVolume * 0.35;
        }
        if (source) {
          if (source.volume !== undefined) {
            source.volume = currentVolume;
          }
          // AudioContextë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° gainNodeë¡œ ì¡°ì ˆ
          if (source.connect && gainNode) {
            // ì´ë¯¸ ì—°ê²°ë˜ì–´ ìˆìœ¼ë©´ ë³¼ë¥¨ì€ gainNodeë¡œ ì¡°ì ˆë¨
          }
        }
        if (customAudio) {
          customAudio.volume = currentVolume;
        }
      }

      function setTimer(min, targetButton) {
        if (timer) clearTimeout(timer);
        if (timerInterval) clearInterval(timerInterval);

        timerMinutes = min;

        // íƒ€ì´ë¨¸ ë²„íŠ¼ í•˜ì´ë¼ì´íŠ¸ ì´ˆê¸°í™”
        document.querySelectorAll(".timer-btn").forEach((btn) => {
          btn.classList.remove("bg-blue-500/30", "hover:bg-blue-500/30");
          btn.classList.add("bg-white/10");
        });

        // ì„ íƒëœ íƒ€ì´ë¨¸ ë²„íŠ¼ í•˜ì´ë¼ì´íŠ¸ (ê³„ì† ë²„íŠ¼ í¬í•¨)
        if (targetButton) {
          targetButton.classList.remove("bg-white/10", "hover:bg-white/15");
          targetButton.classList.add("bg-blue-500/30", "hover:bg-blue-500/30");
        }

        if (min > 0) {
          timerEndTime = Date.now() + min * 60 * 1000;
          timer = setTimeout(() => {
            stopAll();
            showNotification(t("timerEnded"));
          }, min * 60 * 1000);

          // 1ì´ˆë§ˆë‹¤ ë‚¨ì€ ì‹œê°„ ì—…ë°ì´íŠ¸
          timerInterval = setInterval(() => {
            updateTimerDisplay();
            if (timerEndTime <= Date.now()) {
              clearInterval(timerInterval);
              timerInterval = null;
            }
          }, 1000);
        } else {
          timerEndTime = 0;
        }

        updateTimerDisplay();
      }

      function showNotification(message) {
        // ê°„ë‹¨í•œ ì•Œë¦¼ í‘œì‹œ
        const notification = document.createElement("div");
        notification.textContent = message;
        notification.className =
          "fixed top-4 left-1/2 transform -translate-x-1/2 bg-emerald-500 text-white px-6 py-3 rounded-xl shadow-lg z-50 animate-bounce";
        document.body.appendChild(notification);
        setTimeout(() => {
          notification.remove();
        }, 3000);
      }

      function bufferToWavBlob(buffer) {
        const numChannels = buffer.numberOfChannels;
        const sampleRate = buffer.sampleRate;
        const numFrames = buffer.length;
        const dataLength = numFrames * numChannels * 2;
        const wavBuffer = new ArrayBuffer(44 + dataLength);
        const view = new DataView(wavBuffer);

        const writeString = (offset, str) => {
          for (let i = 0; i < str.length; i++) {
            view.setUint8(offset + i, str.charCodeAt(i));
          }
        };

        writeString(0, "RIFF");
        view.setUint32(4, 36 + dataLength, true);
        writeString(8, "WAVE");
        writeString(12, "fmt ");
        view.setUint32(16, 16, true);
        view.setUint16(20, 1, true);
        view.setUint16(22, numChannels, true);
        view.setUint32(24, sampleRate, true);
        view.setUint32(28, sampleRate * numChannels * 2, true);
        view.setUint16(32, numChannels * 2, true);
        view.setUint16(34, 16, true);
        writeString(36, "data");
        view.setUint32(40, dataLength, true);

        const channels = [];
        for (let i = 0; i < numChannels; i++) {
          channels.push(buffer.getChannelData(i));
        }

        let offset = 44;
        for (let i = 0; i < numFrames; i++) {
          for (let ch = 0; ch < numChannels; ch++) {
            let sample = channels[ch][i];
            sample = Math.max(-1, Math.min(1, sample));
            view.setInt16(
              offset,
              sample < 0 ? sample * 0x8000 : sample * 0x7fff,
              true
            );
            offset += 2;
          }
        }

        return new Blob([view], { type: "audio/wav" });
      }

      function playBufferAsWav(buffer, label, button) {
        stopAll();
        const audio = new Audio();
        const blob = bufferToWavBlob(buffer);
        const url = URL.createObjectURL(blob);
        audio.src = url;
        audio.loop = true;
        audio.volume = currentVolume;
        audio.preload = "auto";
        audio
          .play()
          .then(() => {
            logAudio("HTMLAudio(wav): play started", label);
          })
          .catch((error) => {
            showNotification(
              "ì˜¤ë””ì˜¤ ì¬ìƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë³¼ë¥¨ì„ í™•ì¸í•´ì£¼ì„¸ìš”."
            );
            console.error("Audio play error:", error);
          });
        source = audio;
        if (button) {
          highlightButton(button, label);
        } else {
          showStatus(label);
        }
      }

      function createNoiseBuffer(type) {
        const bufferSize = createLoopBufferSize();
        const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
        const data = buffer.getChannelData(0);
        let last = 0;

        for (let i = 0; i < bufferSize; i++) {
          const white = Math.random() * 2 - 1;
          if (type === "pink") {
            last = (last + 0.02 * white) / 1.02;
            data[i] = last * 3;
          } else {
            data[i] = white * 0.6;
          }
        }
        return applyLoopFade(buffer);
      }

      function updateOverlayStatus(label) {
        const overlayStatus = document.getElementById("overlayStatus");
        if (overlayStatus) {
          overlayStatus.textContent = label ? t("overlayStatus", { label }) : "";
        }
      }

      function startOverlayBuffer(buffer, label) {
        if (!customAudio) {
          showNotification(t("uploadFirst"));
          return;
        }
        stopOverlay();
        overlaySource = ctx.createBufferSource();
        overlaySource.buffer = buffer;
        overlaySource.loop = true;
        overlaySource.connect(overlayGainNode);
        overlayGainNode.gain.value = currentVolume * 0.35;
        overlaySource.start();

        overlayName = label;
        updateOverlayStatus(label);
        updateStatusLabel();
      }

      function playNoise(type) {
        logAudio("playNoise", { type });
        const button = event?.target?.closest(".sound-btn");
        const soundNames = t("soundNames");
        const label = type === "pink" ? soundNames.pink : soundNames.white;
        if (useWavOnIOS) {
          init();
          const buffer = createNoiseBuffer(type);
          playBufferAsWav(buffer, label, button);
          return;
        }
        withAudioContext(() => {
          debugBeep();
          const buffer = createNoiseBuffer(type);

          const name = type === "pink" ? soundNames.pink : soundNames.white;
          if (customAudio) {
            startOverlayBuffer(buffer, name);
            return;
          }

          stopAll();
          source = ctx.createBufferSource();
          source.buffer = buffer;
          source.loop = true;
          source.connect(gainNode);
          source.start();
          highlightButton(button, name);
        });
      }

      function playLow() {
        logAudio("playLow");
        const button = event?.target?.closest(".sound-btn");
        const soundNames = t("soundNames");
        const label = soundNames.low;
        if (useWavOnIOS) {
          init();
          const buffer = createSineBuffer(60);
          playBufferAsWav(buffer, label, button);
          return;
        }
        withAudioContext(() => {
          if (customAudio) {
            const buffer = createSineBuffer(60);
            startOverlayBuffer(buffer, label);
            return;
          }

          stopAll();
          const buffer = createSineBuffer(60);
          source = ctx.createBufferSource();
          source.buffer = buffer;
          source.loop = true;
          source.connect(gainNode);
          source.start();

          highlightButton(button, label);
        });
      }

      function playAudio(type) {
        logAudio("playAudio", { type });
        const button = event?.target?.closest(".sound-btn");
        const isRain = type === "rain";
        const soundNames = t("soundNames");
        const label = isRain ? soundNames.rain : soundNames.wave;
        if (useWavOnIOS) {
          init();
          const buffer = isRain ? createRainBuffer() : createWaveBuffer();
          playBufferAsWav(buffer, label, button);
          return;
        }
        withAudioContext(() => {
          const name = isRain ? soundNames.rain : soundNames.wave;
          const buffer = isRain ? createRainBuffer() : createWaveBuffer();

          if (customAudio) {
            startOverlayBuffer(buffer, name);
            return;
          }

          stopAll();
          source = ctx.createBufferSource();
          source.buffer = buffer;
          source.loop = true;
          source.connect(gainNode);
          source.start();

          highlightButton(button, name);
        });
      }

      function createRainBuffer() {
        // ë¹„ ì†Œë¦¬ ìƒì„±: ì—¬ëŸ¬ ì£¼íŒŒìˆ˜ì˜ ë…¸ì´ì¦ˆë¥¼ ì¡°í•©
        const bufferSize = createLoopBufferSize();
        const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
        const data = buffer.getChannelData(0);

        for (let i = 0; i < bufferSize; i++) {
          // ë¹„ ì†Œë¦¬ íš¨ê³¼: ê³ ì£¼íŒŒ ë…¸ì´ì¦ˆ + ì €ì£¼íŒŒ ì§„ë™
          const noise = (Math.random() * 2 - 1) * 0.3;
          const lowFreq = Math.sin(i * 0.001) * 0.1;
          const drop = Math.random() < 0.01 ? Math.random() * 0.5 : 0;
          data[i] = noise + lowFreq + drop;
        }

        return applyLoopFade(buffer);
      }

      function createWaveBuffer() {
        // íŒŒë„ ì†Œë¦¬ ìƒì„±: ì €ì£¼íŒŒ ì§„ë™ + ë…¸ì´ì¦ˆ
        const bufferSize = createLoopBufferSize();
        const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
        const data = buffer.getChannelData(0);

        for (let i = 0; i < bufferSize; i++) {
          // íŒŒë„ íš¨ê³¼: ì €ì£¼íŒŒ ì‚¬ì¸íŒŒ + ë¶€ë“œëŸ¬ìš´ ë…¸ì´ì¦ˆ
          const wave = Math.sin(i * 0.0005) * 0.4;
          const noise = (Math.random() * 2 - 1) * 0.15;
          const foam = Math.random() < 0.02 ? Math.random() * 0.3 : 0;
          data[i] = wave + noise + foam;
        }

        return applyLoopFade(buffer);
      }

      function playNatureSound(type) {
        logAudio("playNatureSound", { type });
        const button = event?.target?.closest(".sound-btn");
        const soundNames = t("soundNames");
        const label = soundNames[type] || type;
        if (useWavOnIOS) {
          init();
          const buffer = createNatureBuffer(type);
          playBufferAsWav(buffer, label, button);
          return;
        }
        withAudioContext(() => {
          const buffer = createNatureBuffer(type);

          if (customAudio) {
            startOverlayBuffer(buffer, label);
            return;
          }

          stopAll();
          source = ctx.createBufferSource();
          source.buffer = buffer;
          source.loop = true;
          source.connect(gainNode);
          source.start();

          highlightButton(button, label);
        });
      }

      function handleFileUpload(event) {
        const file = event.target.files[0];
        if (!file) return;

        if (!file.type.startsWith("audio/")) {
          showNotification(t("audioOnly"));
          return;
        }

        const fileName = document.getElementById("fileName");
        fileName.textContent = file.name;

        const url = URL.createObjectURL(file);
        playCustomAudio(url, file.name);
      }

      function playCustomAudio(url, name) {
        logAudio("playCustomAudio", { url, name });
        stopAll();

        const audio = new Audio(url);
        audio.loop = true;
        audio.volume = currentVolume;

        // ëª¨ë°”ì¼ì—ì„œ ì¬ìƒì„ ë³´ì¥í•˜ê¸° ìœ„í•´ preload ì„¤ì •
        audio.preload = "auto";

        audio.addEventListener("error", () => {
          showNotification(t("audioError"));
          stopAll();
        });

        // ëª¨ë°”ì¼ì—ì„œ ì¬ìƒ ë³´ì¥ - ì‚¬ìš©ì ì¸í„°ë™ì…˜ì—ì„œ ì§ì ‘ í˜¸ì¶œë˜ë¯€ë¡œ ê°€ëŠ¥
        audio
          .play()
          .then(() => {
            logAudio("HTMLAudio: play started");
          })
          .catch((error) => {
            // ì¬ìƒ ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
            showNotification(t("audioPlayError"));
            console.error("Audio play error:", error);
            return;
          });

        customAudio = audio;
        source = audio;
        showStatus(name);

        // ì˜¤ë²„ë ˆì´ ì„¹ì…˜ í‘œì‹œ
        const overlaySection = document.getElementById("overlaySection");
        if (overlaySection) overlaySection.classList.remove("hidden");

        // ì‚¬ìš©ì ì˜¤ë””ì˜¤ ë²„íŠ¼ í•˜ì´ë¼ì´íŠ¸ (ê°€ìƒ ë²„íŠ¼)
        resetButtonStates();
      }

      function addNoiseOverlay(type) {
        if (useWavOnIOS) {
          showNotification(t("iosOverlayNotSupported"));
          return;
        }
        withAudioContext(() => {
          const soundNames = t("soundNames");
          const noiseName = type === "pink" ? soundNames.pink : soundNames.white;
          const buffer = createNoiseBuffer(type);
          startOverlayBuffer(buffer, noiseName);
        });
      }

      function removeNoiseOverlay() {
        stopOverlay();
        updateStatusLabel();
      }

      function recommend(state) {
        const soundNames = t("soundNames");
        if (state === "noisy") {
          const button = document.querySelector(`[data-name="${soundNames.pink}"]`);
          if (button) {
            button.click();
          } else {
            playNoise("pink");
          }
        } else {
          const button = document.querySelector(`[data-name="${soundNames.low}"]`);
          if (button) {
            button.click();
          } else {
            playLow();
          }
        }
      }

      function childMode() {
        const soundNames = t("soundNames");
        const label = soundNames.child;
        if (useWavOnIOS) {
          init();
          const buffer = createSineBuffer(50);
          playBufferAsWav(buffer, label);
          setTimer(30, null);
          return;
        }
        withAudioContext(() => {
          stopAll();
          source = ctx.createOscillator();
          source.type = "sine";
          source.frequency.value = 50;
          source.connect(gainNode);
          source.start();
          setTimer(30, null);
          showStatus(label);
        });
      }

      function toggleFrequencyInfo() {
        const info = document.getElementById("frequencyInfo");
        const toggle = document.getElementById("frequencyToggle");
        if (info.classList.contains("hidden")) {
          info.classList.remove("hidden");
          toggle.textContent = "â–²";
        } else {
          info.classList.add("hidden");
          toggle.textContent = "â–¼";
        }
      }

      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
      document.addEventListener("DOMContentLoaded", () => {
        // ë³¼ë¥¨ ìŠ¬ë¼ì´ë” ìŠ¤íƒ€ì¼ë§
        const volumeSlider = document.getElementById("volumeSlider");
        if (volumeSlider) {
          volumeSlider.style.background = `linear-gradient(to right, #10b981 0%, #10b981 ${
            currentVolume * 100
          }%, rgba(255,255,255,0.2) ${
            currentVolume * 100
          }%, rgba(255,255,255,0.2) 100%)`;
          volumeSlider.addEventListener("input", (e) => {
            const value = e.target.value;
            e.target.style.background = `linear-gradient(to right, #10b981 0%, #10b981 ${value}%, rgba(255,255,255,0.2) ${value}%, rgba(255,255,255,0.2) 100%)`;
          });
        }
      });

      // i18n
      const translations = {
        ko: {
          title: "ì ë“¤ê¸° ë„ìš°ë¯¸",
          subtitle: "ì½”ê³¨ì´Â·ì£¼ë³€ ì†ŒìŒì´ ìˆì–´ë„ ì ë“¤ê¸° í™˜ê²½ì„ ë•ëŠ” ì†Œë¦¬",
          guideTitle: "ğŸ’¤ ì ë“¤ê¸° ê°€ì´ë“œ",
          guideNoisyTitle: "ì‹œë„ëŸ¬ìš´ í™˜ê²½",
          guideNoisyDesc: "í•‘í¬ ë…¸ì´ì¦ˆë‚˜ í™”ì´íŠ¸ ë…¸ì´ì¦ˆë¥¼ ì‚¬ìš©í•˜ì—¬ ì£¼ë³€ ì†ŒìŒì„ ê°€ë ¤ì£¼ì„¸ìš”. íŠ¹íˆ ì½”ê³¨ì´ë‚˜ ë„ë¡œ ì†ŒìŒì— íš¨ê³¼ì ì…ë‹ˆë‹¤.",
          guideQuietTitle: "ì¡°ìš©í•œ í™˜ê²½",
          guideQuietDesc: "ë¶€ë“œëŸ¬ìš´ ì €ìŒì´ë‚˜ ìì—° ì†Œë¦¬(ë¹„, íŒŒë„)ë¥¼ ì‚¬ìš©í•˜ë©´ ë” ê¹Šì€ ì ì— ë¹ ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
          guideVolumeTitle: "ë³¼ë¥¨ ì¡°ì ˆ",
          guideVolumeDesc: "ë„ˆë¬´ í¬ì§€ ì•Šê²Œ ì¡°ì ˆí•˜ì„¸ìš”. ë³´í†µ 40-60% ì •ë„ê°€ ì ë‹¹í•˜ë©°, ì£¼ë³€ ì†ŒìŒë³´ë‹¤ ì•½ê°„ í¬ê²Œë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.",
          guideTimerTitle: "íƒ€ì´ë¨¸ í™œìš©",
          guideTimerDesc: "ìˆ˜ë©´ ì‹œê°„ì— ë§ì¶° íƒ€ì´ë¨¸ë¥¼ ì„¤ì •í•˜ë©´ ìë™ìœ¼ë¡œ êº¼ì ¸ì„œ ê¹Šì€ ì ì„ ë°©í•´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
          frequencyTitle: "ğŸµ ì ë“¤ê¸° ì¢‹ì€ ì£¼íŒŒìˆ˜ ì•Œì•„ë³´ê¸°",
          deltaTitle: "ë¸íƒ€íŒŒ (0.5-4Hz)",
          deltaDesc: "ê°€ì¥ ê¹Šì€ ìˆ˜ë©´ ë‹¨ê³„ì—ì„œ ë‚˜íƒ€ë‚˜ëŠ” ì£¼íŒŒìˆ˜ì…ë‹ˆë‹¤. ê·€ë¡œ ë“¤ì„ ìˆ˜ ì—†ì–´ 60Hz ì •ë„ì˜ ë¶€ë“œëŸ¬ìš´ ì €ìŒê³¼ íŒŒë„ ë¦¬ë“¬ìœ¼ë¡œ ë¸íƒ€ ëŠë‚Œì„ ë§Œë“­ë‹ˆë‹¤ (ë¶€ë“œëŸ¬ìš´ ì €ìŒ, íŒŒë„ ì†Œë¦¬ì™€ ì˜ ì–´ìš¸ë¦¼).",
          thetaTitle: "ì„¸íƒ€íŒŒ (4-8Hz)",
          thetaDesc: "ê¹Šì€ íœ´ì‹ê³¼ ëª…ìƒ ìƒíƒœì—ì„œ ë‚˜íƒ€ë‚˜ë©°, ì ë“¤ê¸° ì§ì „ ë‹¨ê³„ì—ì„œ ë„ì›€ì´ ë©ë‹ˆë‹¤. í•‘í¬ ë…¸ì´ì¦ˆë‚˜ ë¹„/íŒŒë„ ê°™ì€ ëŠë¦° íŒŒë™ ì†Œë¦¬ê°€ ì„¸íƒ€ ì˜ì—­ ê°ê°ì„ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.",
          alphaTitle: "ì•ŒíŒŒíŒŒ (8-13Hz)",
          alphaDesc: "í¸ì•ˆí•œ ê°ì„± ìƒíƒœë¡œ, ê¸´ì¥ì„ í’€ê³  ì ë“¤ ì¤€ë¹„ë¥¼ í•  ë•Œ ë„ì›€ì´ ë©ë‹ˆë‹¤.",
          whiteNoiseTitle: "í™”ì´íŠ¸ ë…¸ì´ì¦ˆ",
          whiteNoiseDesc: "ëª¨ë“  ì£¼íŒŒìˆ˜ë¥¼ ê· ë“±í•˜ê²Œ í¬í•¨í•˜ì—¬ ì£¼ë³€ ì†ŒìŒì„ íš¨ê³¼ì ìœ¼ë¡œ ê°€ë¦½ë‹ˆë‹¤. ì½”ê³¨ì´ë‚˜ ë„ë¡œ ì†ŒìŒ ì°¨ë‹¨ì— ì¢‹ìŠµë‹ˆë‹¤.",
          pinkNoiseTitle: "í•‘í¬ ë…¸ì´ì¦ˆ",
          pinkNoiseDesc: "ê³ ì£¼íŒŒë³´ë‹¤ ì €ì£¼íŒŒì— ë” ë§ì€ ì—ë„ˆì§€ë¥¼ ê°€ì§„ ë…¸ì´ì¦ˆë¡œ, í™”ì´íŠ¸ ë…¸ì´ì¦ˆë³´ë‹¤ ë” ìì—°ìŠ¤ëŸ½ê³  í¸ì•ˆí•©ë‹ˆë‹¤.",
          situationLabel: "ì§€ê¸ˆ ì£¼ë³€ì€ ì–´ë–¤ê°€ìš”?",
          situationQuiet: "ì§€ê¸ˆ ì¡°ìš©í•¨",
          situationNoisy: "ì§€ê¸ˆ ì‹œë„ëŸ¬ì›€",
          statusPlaying: "ì¬ìƒ ì¤‘",
          statusStop: "ì •ì§€",
          customAudioLabel: "ë‚´ ì†Œë¦¬ ì¶”ê°€",
          fileUploadLabel: "íŒŒì¼ ì—…ë¡œë“œ",
          fileSelect: "íŒŒì¼ ì„ íƒ",
          overlayLabel: "ë§ì”Œìš°ê¸° (ì„ íƒ)",
          overlayWhite: "í™”ì´íŠ¸ ë…¸ì´ì¦ˆ",
          overlayPink: "í•‘í¬ ë…¸ì´ì¦ˆ",
          overlayRemove: "ë§ì”Œìš°ê¸° ì œê±°",
          overlayHint: "ìœ„ì˜ ì†Œë¦¬Â·ìì—° ì†Œë¦¬ ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ ë‚´ íŒŒì¼ ìœ„ì— ë§ì”Œìš¸ ìˆ˜ ìˆì–´ìš”",
          soundSelectLabel: "ì†Œë¦¬ ì„ íƒ",
          whiteNoiseBtn: "í™”ì´íŠ¸ ë…¸ì´ì¦ˆ (20Hz~20kHz)",
          pinkNoiseBtn: "í•‘í¬ ë…¸ì´ì¦ˆ (ì €ìŒ ê°•í™”)",
          rainBtn: "ë¹„ ì˜¤ëŠ” ì†Œë¦¬ (500~8kHz ëŠë‚Œ)",
          waveBtn: "íŒŒë„ ì†Œë¦¬ (1~200Hz ë¦¬ë“¬)",
          lowBtn: "ë¶€ë“œëŸ¬ìš´ ì €ìŒ (60Hz)",
          natureLabel: "ğŸŒ¿ ìì—° ì†Œë¦¬",
          windBtn: "ë°”ëŒ ì†Œë¦¬ (200~800Hz)",
          fireplaceBtn: "ë²½ë‚œë¡œ ì†Œë¦¬ (60~200Hz)",
          forestBtn: "ìˆ² ì†Œë¦¬ (2~4kHz ìƒˆì†Œë¦¬)",
          streamBtn: "ì‹œëƒ‡ë¬¼ ì†Œë¦¬ (300~2kHz)",
          thunderBtn: "ì²œë‘¥ ì†Œë¦¬ (40~120Hz)",
          birdsBtn: "ì•„ì¹¨ ìƒˆì†Œë¦¬ (3~8kHz)",
          nightBtn: "ë°¤ ë²Œë ˆ ì†Œë¦¬ (2~6kHz)",
          meadowBtn: "ë“¤íŒ ë°”ëŒ ì†Œë¦¬ (200~1kHz)",
          volumeLabel: "ë³¼ë¥¨ ì¡°ì ˆ",
          timerLabel: "íƒ€ì´ë¨¸",
          timer15: "15ë¶„",
          timer30: "30ë¶„",
          timer60: "1ì‹œê°„",
          timerContinue: "ê³„ì†",
          childModeTitle: "ğŸ‘¶ ì•„ì´ ì¬ìš°ê¸° ëª¨ë“œ",
          childModeDesc: "ê°‘ì‘ìŠ¤ëŸ¬ìš´ ì†Œë¦¬ ì—†ëŠ”, ì•„ì£¼ ì¼ì •í•œ ì†Œë¦¬ë§Œ ì œê³µí•©ë‹ˆë‹¤",
          childModeStart: "ì•„ì´ ì¬ìš°ê¸° ì‹œì‘",
          stopBtn: "ì •ì§€",
          quickGuideTitle: "ğŸ’¡ ë¹ ë¥¸ ê°€ì´ë“œ",
          quickGuide1: "â€¢ ì‹œë„ëŸ¬ìš´ í™˜ê²½: í•‘í¬/í™”ì´íŠ¸ ë…¸ì´ì¦ˆ ì‚¬ìš©",
          quickGuide2: "â€¢ ì¡°ìš©í•œ í™˜ê²½: ìì—° ì†Œë¦¬ë‚˜ ë¶€ë“œëŸ¬ìš´ ì €ìŒ",
          quickGuide3: "â€¢ ë³¼ë¥¨ì€ 40-60% ì •ë„ê°€ ì ë‹¹í•©ë‹ˆë‹¤",
          quickGuide4: "â€¢ íƒ€ì´ë¨¸ë¥¼ ì„¤ì •í•˜ë©´ ìë™ìœ¼ë¡œ êº¼ì§‘ë‹ˆë‹¤",
          footer: "ë³¸ ì„œë¹„ìŠ¤ëŠ” ì˜ë£ŒÂ·ìˆ˜ë©´ ì¹˜ë£Œ ëª©ì ì´ ì•„ë‹Œ<br />ì ë“¤ê¸° í™˜ê²½ì„ ë•ê¸° ìœ„í•œ ì°¸ê³ ìš© ì†Œë¦¬ ì œê³µ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.",
          otherServices: "ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë³´ê¸°",
          timerRemaining: "â° ë‚¨ì€ ì‹œê°„: {minutes}ë¶„ {seconds}ì´ˆ",
          timerContinue: "ê³„ì† ì¬ìƒ",
          audioActivating: "ì†Œë¦¬ í™œì„±í™” ì¤‘ì…ë‹ˆë‹¤. í•œ ë²ˆ ë” ëˆŒëŸ¬ì£¼ì„¸ìš”.",
          timerEnded: "íƒ€ì´ë¨¸ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤",
          audioOnly: "ì˜¤ë””ì˜¤ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤",
          audioError: "ì˜¤ë””ì˜¤ë¥¼ ì¬ìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
          audioPlayError: "ì˜¤ë””ì˜¤ ì¬ìƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë³¼ë¥¨ì„ í™•ì¸í•´ì£¼ì„¸ìš”.",
          iosOverlayNotSupported: "iOSì—ì„œëŠ” ë§ì”Œìš°ê¸°ê°€ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤",
          overlayStatus: "âœ“ {label} ë§ì”Œì›€",
          uploadFirst: "ë¨¼ì € ì˜¤ë””ì˜¤ íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”",
          soundNames: {
            white: "í™”ì´íŠ¸ ë…¸ì´ì¦ˆ",
            pink: "í•‘í¬ ë…¸ì´ì¦ˆ",
            rain: "ë¹„ ì˜¤ëŠ” ì†Œë¦¬",
            wave: "íŒŒë„ ì†Œë¦¬",
            low: "ë¶€ë“œëŸ¬ìš´ ì €ìŒ",
            wind: "ë°”ëŒ ì†Œë¦¬",
            fireplace: "ë²½ë‚œë¡œ ì†Œë¦¬",
            forest: "ìˆ² ì†Œë¦¬",
            stream: "ì‹œëƒ‡ë¬¼ ì†Œë¦¬",
            thunder: "ì²œë‘¥ ì†Œë¦¬",
            birds: "ì•„ì¹¨ ìƒˆì†Œë¦¬",
            night: "ë°¤ ë²Œë ˆ ì†Œë¦¬",
            meadow: "ë“¤íŒ ë°”ëŒ ì†Œë¦¬",
            child: "ì•„ì´ ì¬ìš°ê¸° ëª¨ë“œ",
          },
        },
        en: {
          title: "Sleep Sound Helper",
          subtitle: "Sounds that help you fall asleep even with noise or snoring",
          guideTitle: "ğŸ’¤ Sleep Guide",
          guideNoisyTitle: "Noisy environment",
          guideNoisyDesc: "Use pink or white noise to mask surrounding sounds. Especially effective for snoring or road noise.",
          guideQuietTitle: "Quiet environment",
          guideQuietDesc: "Using soft low tones or natural sounds (rain, waves) can help you fall into deeper sleep.",
          guideVolumeTitle: "Volume control",
          guideVolumeDesc: "Adjust it not too loud. Usually 40-60% is appropriate, just slightly louder than surrounding noise.",
          guideTimerTitle: "Using timer",
          guideTimerDesc: "Setting a timer according to sleep time will automatically turn off and not disturb deep sleep.",
          frequencyTitle: "ğŸµ Learn about sleep-friendly frequencies",
          deltaTitle: "Delta waves (0.5-4Hz)",
          deltaDesc: "Frequencies that appear in the deepest sleep stage. Since they cannot be heard by ear, they create a delta feeling with soft low tones around 60Hz and wave rhythms (goes well with soft low tones and wave sounds).",
          thetaTitle: "Theta waves (4-8Hz)",
          thetaDesc: "Appear in deep relaxation and meditation states, helpful in the stage just before falling asleep. Slow wave sounds like pink noise or rain/waves create theta area sensations.",
          alphaTitle: "Alpha waves (8-13Hz)",
          alphaDesc: "A relaxed awake state, helpful when relaxing tension and preparing to sleep.",
          whiteNoiseTitle: "White noise",
          whiteNoiseDesc: "Contains all frequencies equally to effectively mask surrounding sounds. Good for blocking snoring or road noise.",
          pinkNoiseTitle: "Pink noise",
          pinkNoiseDesc: "Noise with more energy in low frequencies than high frequencies, more natural and comfortable than white noise.",
          situationLabel: "How is your environment right now?",
          situationQuiet: "Quiet now",
          situationNoisy: "Noisy now",
          statusPlaying: "Playing",
          statusStop: "Stop",
          customAudioLabel: "Add my sound",
          fileUploadLabel: "File upload",
          fileSelect: "Select file",
          overlayLabel: "Overlay (optional)",
          overlayWhite: "White noise",
          overlayPink: "Pink noise",
          overlayRemove: "Remove overlay",
          overlayHint: "You can also overlay sounds by pressing the sound/nature sound buttons above your file",
          soundSelectLabel: "Select sound",
          whiteNoiseBtn: "White noise (20Hz~20kHz)",
          pinkNoiseBtn: "Pink noise (low frequency enhanced)",
          rainBtn: "Rain sound (500~8kHz feel)",
          waveBtn: "Wave sound (1~200Hz rhythm)",
          lowBtn: "Soft low tone (60Hz)",
          natureLabel: "ğŸŒ¿ Nature sounds",
          windBtn: "Wind sound (200~800Hz)",
          fireplaceBtn: "Fireplace sound (60~200Hz)",
          forestBtn: "Forest sound (2~4kHz bird sounds)",
          streamBtn: "Stream sound (300~2kHz)",
          thunderBtn: "Thunder sound (40~120Hz)",
          birdsBtn: "Morning bird sounds (3~8kHz)",
          nightBtn: "Night insect sounds (2~6kHz)",
          meadowBtn: "Meadow wind sound (200~1kHz)",
          volumeLabel: "Volume control",
          timerLabel: "Timer",
          timer15: "15 min",
          timer30: "30 min",
          timer60: "1 hour",
          timerContinue: "Continue",
          childModeTitle: "ğŸ‘¶ Baby sleep mode",
          childModeDesc: "Provides only very constant sounds without sudden sounds",
          childModeStart: "Start baby sleep",
          stopBtn: "Stop",
          quickGuideTitle: "ğŸ’¡ Quick guide",
          quickGuide1: "â€¢ Noisy environment: Use pink/white noise",
          quickGuide2: "â€¢ Quiet environment: Natural sounds or soft low tones",
          quickGuide3: "â€¢ Volume around 40-60% is appropriate",
          quickGuide4: "â€¢ Setting a timer will automatically turn off",
          footer: "This service is not for medical/sleep treatment purposes<br />but a reference sound service to help with sleep environment.",
          otherServices: "View other services",
          timerRemaining: "â° Time remaining: {minutes}m {seconds}s",
          timerContinue: "Continue playing",
          audioActivating: "Activating sound. Please press once more.",
          timerEnded: "Timer has ended",
          audioOnly: "Only audio files can be uploaded",
          audioError: "Cannot play audio",
          audioPlayError: "Failed to play audio. Please check the volume.",
          iosOverlayNotSupported: "Overlay is not supported on iOS",
          overlayStatus: "âœ“ {label} overlay",
          uploadFirst: "Please upload an audio file first",
          soundNames: {
            white: "White noise",
            pink: "Pink noise",
            rain: "Rain sound",
            wave: "Wave sound",
            low: "Soft low tone",
            wind: "Wind sound",
            fireplace: "Fireplace sound",
            forest: "Forest sound",
            stream: "Stream sound",
            thunder: "Thunder sound",
            birds: "Morning bird sounds",
            night: "Night insect sounds",
            meadow: "Meadow wind sound",
            child: "Baby sleep mode",
          },
        },
      };

      const defaultLang = "ko";
      const supportedLangs = ["ko", "en"];
      let currentLang = defaultLang;

      function t(key, vars = {}) {
        const langTable = translations[currentLang] || translations.ko;
        const template = langTable?.[key] ?? translations.ko?.[key] ?? key;
        if (typeof template !== "string") {
          return template;
        }
        return template.replace(/\{(\w+)\}/g, (_, token) =>
          vars[token] !== undefined ? vars[token] : `{${token}}`
        );
      }

      function applyTranslations() {
        document.title = t("title");
        document.querySelectorAll("[data-i18n]").forEach((el) => {
          el.textContent = t(el.dataset.i18n);
        });
        document.querySelectorAll("[data-i18n-html]").forEach((el) => {
          el.innerHTML = t(el.dataset.i18nHtml);
        });
        // Update sound names in JavaScript
        if (typeof window.updateSoundNames === "function") {
          window.updateSoundNames();
        }
      }

      function setLang(lang, options = {}) {
        const nextLang = translations[lang] ? lang : defaultLang;
        currentLang = nextLang;
        document.documentElement.lang = nextLang;
        localStorage.setItem("preferredLang", nextLang);
        document.querySelectorAll(".lang-switch button").forEach((button) => {
          button.classList.toggle("active", button.dataset.lang === nextLang);
        });
        applyTranslations();
        if (options.updateUrl) {
          const url = new URL(window.location.href);
          url.searchParams.set("lang", nextLang);
          window.history.replaceState({}, "", url);
        }
      }

      function detectLang() {
        const params = new URLSearchParams(window.location.search);
        const paramLang = params.get("lang");
        if (supportedLangs.includes(paramLang)) return paramLang;
        const stored = localStorage.getItem("preferredLang");
        if (supportedLangs.includes(stored)) return stored;
        const browserLang =
          navigator.languages && navigator.languages.length
            ? navigator.languages[0]
            : navigator.language;
        if (browserLang && browserLang.toLowerCase().startsWith("ko")) {
          return "ko";
        }
        return defaultLang;
      }

      document.querySelectorAll(".lang-switch button").forEach((button) => {
        button.addEventListener("click", () => {
          setLang(button.dataset.lang, { updateUrl: true });
        });
      });

      // Update sound names function
      window.updateSoundNames = function() {
        const soundNames = t("soundNames");
        // Update sound name mappings in JavaScript functions
        if (typeof window.soundNamesMap === "undefined") {
          window.soundNamesMap = {};
        }
        Object.assign(window.soundNamesMap, soundNames);
      };

      setLang(detectLang(), { updateUrl: false });
    </script>
  
<ins class="adsbygoogle"
     style="display:block; text-align:center"
     data-ad-format="fluid"
     data-ad-layout-key="-6t+ed+2i-1n-4w"
     data-ad-client="ca-pub-1204894220949193"
     data-ad-slot="7300458753"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
    
</body>
</html>
